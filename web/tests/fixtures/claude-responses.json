{
  "valid_unsafe": {
    "input": "{\"verdict\": \"unsafe\", \"flagged_ingredients\": [\"wheat flour\"], \"allergen_warnings\": [], \"explanation\": \"Contains wheat\", \"confidence\": \"high\"}",
    "expected": {
      "verdict": "unsafe",
      "flagged_ingredients": ["wheat flour"],
      "allergen_warnings": [],
      "explanation": "Contains wheat",
      "confidence": "high",
      "mode": "label"
    }
  },
  "valid_safe": {
    "input": "{\"verdict\": \"safe\", \"flagged_ingredients\": [], \"allergen_warnings\": [], \"explanation\": \"No gluten found\", \"confidence\": \"high\"}",
    "expected": {
      "verdict": "safe",
      "flagged_ingredients": [],
      "allergen_warnings": [],
      "explanation": "No gluten found",
      "confidence": "high",
      "mode": "label"
    }
  },
  "valid_with_surrounding_text": {
    "input": "Here's my analysis:\n{\"verdict\": \"safe\", \"flagged_ingredients\": [], \"allergen_warnings\": [], \"explanation\": \"No gluten found\", \"confidence\": \"high\"}\nLet me know if you need more.",
    "expected": {
      "verdict": "safe",
      "flagged_ingredients": [],
      "allergen_warnings": [],
      "explanation": "No gluten found",
      "confidence": "high",
      "mode": "label"
    }
  },
  "missing_optional_fields": {
    "input": "{\"verdict\": \"caution\"}",
    "expected": {
      "verdict": "caution",
      "flagged_ingredients": [],
      "allergen_warnings": [],
      "explanation": "",
      "confidence": "medium",
      "mode": "label"
    }
  },
  "invalid_verdict_value": {
    "input": "{\"verdict\": \"maybe\", \"flagged_ingredients\": [], \"explanation\": \"Not sure\"}",
    "expected": {
      "verdict": "caution",
      "flagged_ingredients": [],
      "allergen_warnings": [],
      "explanation": "Unable to fully analyze the ingredients. Please review manually.",
      "confidence": "low"
    }
  },
  "no_json_found": {
    "input": "I could not analyze this image properly.",
    "expected": {
      "verdict": "caution",
      "flagged_ingredients": [],
      "allergen_warnings": [],
      "explanation": "Unable to fully analyze the ingredients. Please review manually.",
      "confidence": "low"
    }
  },
  "malformed_json": {
    "input": "{\"verdict\": \"safe\", flagged_ingredients: [broken",
    "expected": {
      "verdict": "caution",
      "flagged_ingredients": [],
      "allergen_warnings": [],
      "explanation": "Unable to fully analyze the ingredients. Please review manually.",
      "confidence": "low"
    }
  },
  "empty_response": {
    "input": "",
    "expected": {
      "verdict": "caution",
      "flagged_ingredients": [],
      "allergen_warnings": [],
      "explanation": "Unable to fully analyze the ingredients. Please review manually.",
      "confidence": "low"
    }
  },
  "valid_menu_response": {
    "input": "{\"mode\": \"menu\", \"verdict\": \"caution\", \"menu_items\": [{\"name\": \"Grilled Salmon\", \"verdict\": \"safe\", \"notes\": \"No gluten ingredients listed\"}, {\"name\": \"Garden Salad\", \"verdict\": \"safe\", \"notes\": \"Safe without croutons\"}, {\"name\": \"Grilled Chicken\", \"verdict\": \"safe\", \"notes\": \"Appears gluten-free as described\"}, {\"name\": \"Caesar Salad\", \"verdict\": \"caution\", \"notes\": \"Has croutons (wheat) — ask to remove. Check the dressing too.\"}, {\"name\": \"Pasta Bolognese\", \"verdict\": \"unsafe\", \"notes\": \"Contains wheat pasta\"}, {\"name\": \"Fish & Chips\", \"verdict\": \"unsafe\", \"notes\": \"Battered with wheat flour\"}], \"flagged_ingredients\": [], \"allergen_warnings\": [\"Menu does not list full ingredients — ask your server about specific dishes\"], \"explanation\": \"3 items look safe, 1 needs a modification, and 2 are unsafe.\", \"confidence\": \"medium\"}",
    "expected": {
      "mode": "menu",
      "verdict": "caution",
      "menu_items": [
        { "name": "Grilled Salmon", "verdict": "safe", "notes": "No gluten ingredients listed" },
        { "name": "Garden Salad", "verdict": "safe", "notes": "Safe without croutons" },
        { "name": "Grilled Chicken", "verdict": "safe", "notes": "Appears gluten-free as described" },
        { "name": "Caesar Salad", "verdict": "caution", "notes": "Has croutons (wheat) — ask to remove. Check the dressing too." },
        { "name": "Pasta Bolognese", "verdict": "unsafe", "notes": "Contains wheat pasta" },
        { "name": "Fish & Chips", "verdict": "unsafe", "notes": "Battered with wheat flour" }
      ],
      "flagged_ingredients": [],
      "allergen_warnings": ["Menu does not list full ingredients — ask your server about specific dishes"],
      "explanation": "3 items look safe, 1 needs a modification, and 2 are unsafe.",
      "confidence": "medium"
    }
  },
  "menu_with_invalid_items": {
    "input": "{\"mode\": \"menu\", \"verdict\": \"caution\", \"menu_items\": [{\"name\": \"Good Item\", \"verdict\": \"safe\", \"notes\": \"OK\"}, {\"name\": \"Bad Item\", \"verdict\": \"invalid\", \"notes\": \"Should be normalized to caution\"}, {\"verdict\": \"safe\", \"notes\": \"Missing name\"}], \"flagged_ingredients\": [], \"allergen_warnings\": [], \"explanation\": \"Test\", \"confidence\": \"medium\"}",
    "expected": {
      "mode": "menu",
      "verdict": "caution",
      "menu_items": [
        { "name": "Good Item", "verdict": "safe", "notes": "OK" },
        { "name": "Bad Item", "verdict": "caution", "notes": "Should be normalized to caution" }
      ],
      "flagged_ingredients": [],
      "allergen_warnings": [],
      "explanation": "Test",
      "confidence": "medium"
    }
  }
}
